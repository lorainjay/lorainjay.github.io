<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="æ€»ä¹‹å²æœˆæ¼«é•¿,ç„¶è€Œå€¼å¾—ç­‰å¾…"><meta name="theme-color" content="#2d4356"><meta name="baidu-site-verification"><title>æ³›å‹åœ¨é¡¹ç›®ä¸­ä¸æ€ä¹ˆç”¨ï¼Ÿè¿™æ¬¡ç»“åˆå®æˆ˜ï¼ | Lorain's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.png"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Lorain's Blog" type="application/atom+xml">
</head><link rel="stylesheet" type="text/css" href="/plugins/highlight/atom-one-dark.min.css"><script type="text/javascript" src="/plugins/highlight/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();
</script><script type="text/javascript" src="/js/ready.js" async></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><body class="night"><div class="mobile-head" id="mobile-head"><div class="navbar-icon"><span></span><span></span><span></span></div><div class="navbar-title"><a href="/">LITREILY</a></div><div class="navbar-search"><!--= show a circle here--></div></div><div class="h-wrapper" id="menu"><nav class="h-head box"><div class="m-hdimg"><a class="hdimg img" href="/"><img class="nofancybox" src="/img/profile.jpg" width="128" height="128"></a><h1 class="ttl"><a href="/">Lorain's Blog</a></h1></div><p class="m-desc">å¿ƒä¹‹æ‰€å‘ï¼Œæ— æƒ§æ— æ‚”,<br>æ„¿æ±‚ä»å¾—ä»ï¼Œå¤æ— æ€¨æ€¼ï¼</p><div class="m-nav"><ul><li><span class="dot">â—</span><a href="/archives/">å½’æ¡£</a></li><li><span class="dot">â—</span><a href="/categories/">åˆ†ç±»</a></li><li><span class="dot">â—</span><a href="/tags/">æ ‡ç­¾</a></li><li><span class="dot">â—</span><a href="/about/">å…³äº</a></li><li><span class="dot">â—</span><a href="/atom.xml">RSS</a></li><li class="m-sch"><form class="form" id="j-formsch" method="get"><input class="txt" type="text" id="local-search-input" name="q" value="æœç´¢" onfocus="if(this.value=='æœç´¢'){this.value='';}" onblur="if(this.value==''){this.value='æœç´¢';}"><input type="text" style="display:none;"></form></li></ul><div id="local-search-result"></div></div></nav></div><div id="back2Top"><a class="fa fa-arrow-up" title="Back to top" href="#"></a></div><div class="box" id="container"><div class="l-wrapper"><div class="l-content box"><div class="l-post l-post-art"><article class="p-art"><div class="p-header box"><h1 class="p-title">æ³›å‹åœ¨é¡¹ç›®ä¸­ä¸æ€ä¹ˆç”¨ï¼Ÿè¿™æ¬¡ç»“åˆå®æˆ˜ï¼</h1><div class="p-info"><span class="p-date"><i class="fa fa-calendar"></i><a href="/posts/20748c35.html">2024-02-14</a></span><span class="p-category"><i class="fa fa-folder"></i><a href="/categories/Java/">Java</a></span><span class="p-view" id="busuanzi_container_page_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span></span></div></div><div class="p-content"><meta name="referrer" content="no-referrer" />

<blockquote>
<p>æ³›å‹åœ¨é¡¹ç›®ä¸­ç”¨çš„ç¡®å®ç›¸å¯¹æ²¡æœ‰é‚£ä¹ˆå¤šï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æä¾›ä¸€äº›ä¾¿æ·ï¼Œæœ¬æ–‡å…ˆä»åŸºç¡€ä»‹ç»ï¼Œç„¶ååœ¨æ–‡ç« æœ€åè®²è§£é¡¹ç›®å®æˆ˜ä¸­çš„ä¸€äº›ä½¿ç”¨ï¼Œè¶…çº§è¯¦ç»†ï¼ğŸŒŸ</p>
</blockquote>
<p>[TOC]</p>
<h1 id="æ³›å‹åŸºç¡€"><a href="#æ³›å‹åŸºç¡€" class="headerlink" title="æ³›å‹åŸºç¡€"></a>æ³›å‹åŸºç¡€</h1><h2 id="ä¸ºä»€ä¹ˆå¼•å…¥æ³›å‹"><a href="#ä¸ºä»€ä¹ˆå¼•å…¥æ³›å‹" class="headerlink" title="ä¸ºä»€ä¹ˆå¼•å…¥æ³›å‹"></a>ä¸ºä»€ä¹ˆå¼•å…¥æ³›å‹</h2><ul>
<li><strong>é€‚ç”¨äºå¤šç§æ•°æ®ç±»å‹æ‰§è¡Œç›¸åŒçš„ä»£ç </strong>ï¼ˆä»£ç å¤ç”¨ï¼‰</li>
<li>æ³›å‹ä¸­çš„ç±»å‹åœ¨ä½¿ç”¨æ—¶æŒ‡å®šï¼Œä¸éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆ<strong>ç±»å‹å®‰å…¨</strong>ï¼Œç¼–è¯‘å™¨ä¼š<strong>æ£€æŸ¥ç±»å‹</strong>ï¼‰</li>
<li>Javaæ³›å‹ä¹Ÿæ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œåœ¨<strong>ç¼–è¯‘é˜¶æ®µå®Œæˆç±»å‹çš„è½¬æ¢çš„å·¥ä½œ</strong>ï¼Œé¿å…åœ¨è¿è¡Œæ—¶å¼ºåˆ¶ç±»å‹è½¬æ¢è€Œå‡ºç°ClassCastException,ç±»å‹è½¬åŒ–å¼‚å¸¸ã€‚</li>
</ul>
<h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><ul>
<li>ä¸å¼•å…¥æ³›å‹</li>
</ul>
<pre><code class="java">public class target_01 &#123;
    public static void main(String[] args) &#123;
        List list = new ArrayList();
        list.add(11);
        list.add(&quot;è½é›¨æ—¢ç„¶&quot;);
        for (int i = 0; i &lt; list.size(); i++) &#123;
            System.out.println((String)list.get(i));
        &#125;
    &#125;
&#125;
</code></pre>
<p>ä¼šæŠ¥ç±»å‹è½¬æ¢å¼‚å¸¸ï¼š<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/46b5cd26895e468a86a1d210994cc6b1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1432&h=262&s=35825&e=png&b=202124" alt="image.png"></p>
<ul>
<li>ä½¿ç”¨æ³›å‹</li>
</ul>
<pre><code class="java">public class target_01 &#123;
    public static void main(String[] args) &#123;
        List&lt;String&gt; list = new ArrayList();
        list.add(&quot;è½é›¨æ—¢ç„¶&quot;);
        for (int i = 0; i &lt; list.size(); i++) &#123;
            System.out.println((String)list.get(i));
        &#125;
    &#125;
&#125;
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0b342e5999f74c66a171e95f213e2c51~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=918&h=236&s=12681&e=png&b=1e1f22" alt="image.png"><br>åœ¨ä¸Šè¿°çš„å®ä¾‹ä¸­ï¼Œæˆ‘ä»¬åªèƒ½æ·»åŠ Stringç±»å‹çš„æ•°æ®ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</p>
<h2 id="æ³›å‹çš„åŸºæœ¬ä½¿ç”¨"><a href="#æ³›å‹çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="æ³›å‹çš„åŸºæœ¬ä½¿ç”¨"></a>æ³›å‹çš„åŸºæœ¬ä½¿ç”¨</h2><h3 id="æ³›å‹ç±»"><a href="#æ³›å‹ç±»" class="headerlink" title="æ³›å‹ç±»"></a>æ³›å‹ç±»</h3><ul>
<li>æ³›å‹ç±»æ¦‚è¿°ï¼šæŠŠæ³›å‹å®šä¹‰åœ¨ç±»ä¸Š</li>
<li>å®šä¹‰æ ¼å¼ï¼š</li>
</ul>
<blockquote>
<p>æ³¨æ„äº‹é¡¹ï¼šæ³›å‹ç±»å‹å¿…é¡»æ˜¯å¼•ç”¨ç±»å‹ï¼ˆéåŸºæœ¬æ•°æ®ç±»å‹ï¼‰</p>
</blockquote>
<h3 id="æ³›å‹æ¥å£"><a href="#æ³›å‹æ¥å£" class="headerlink" title="æ³›å‹æ¥å£"></a>æ³›å‹æ¥å£</h3><ul>
<li>æ³›å‹æ–¹æ³•æ¦‚è¿°ï¼šæŠŠæ³›å‹å®šä¹‰åœ¨æ–¹æ³•ä¸Š</li>
<li>å®šä¹‰æ ¼å¼ï¼š</li>
</ul>
<blockquote>
<p>æ³¨æ„è¦ç‚¹ï¼š<strong>æ–¹æ³•å£°æ˜</strong>ä¸­å®šä¹‰çš„<strong>å½¢å‚åªèƒ½åœ¨è¯¥æ–¹æ³•é‡Œä½¿ç”¨</strong>ï¼Œè€Œ<strong>æ¥å£ã€ç±»å£°æ˜ä¸­å®šä¹‰çš„ç±»å‹å½¢å‚</strong>åˆ™å¯ä»¥åœ¨æ•´ä¸ªæ¥å£ã€ç±»ä¸­ä½¿ç”¨ã€‚å½“è°ƒç”¨fun()æ–¹æ³•æ—¶ï¼Œæ ¹æ®ä¼ å…¥çš„å®é™…å¯¹è±¡ï¼Œç¼–è¯‘å™¨å°±ä¼šåˆ¤æ–­å‡ºç±»å‹å½¢å‚Tæ‰€ä»£è¡¨çš„å®é™…ç±»å‹ã€‚</p>
</blockquote>
<pre><code class="java">class Demo &#123;
  // æ³›å‹æ–¹æ³•ï¼Œå¯ä»¥æ¥æ”¶ä»»æ„ç±»å‹çš„æ•°æ®
  public &lt;T&gt; T fun(T t) &#123;
    // ç›´æ¥å°†å‚æ•°è¿”å›
    return t;
  &#125;
&#125;

public class GenericsDemo26 &#123;
  public static void main(String args[]) &#123;
    // å®ä¾‹åŒ–Demoå¯¹è±¡
    Demo d = new Demo();
    // ä¼ é€’å­—ç¬¦ä¸²
    String str = d.fun(&quot;è½é›¨æ—¢ç„¶&quot;);
    // ä¼ é€’æ•°å­—ï¼Œè‡ªåŠ¨è£…ç®±
    int i = d.fun(30);
    // è¾“å‡ºå­—ç¬¦ä¸²å†…å®¹
    System.out.println(str);
    // è¾“å‡ºæ•°å­—å†…å®¹
    System.out.println(i);
  &#125;
//  è¾“å‡ºï¼š
//  è½é›¨æ—¢ç„¶
//  30
&#125;
</code></pre>
<h3 id="æ³›å‹æ–¹æ³•"><a href="#æ³›å‹æ–¹æ³•" class="headerlink" title="æ³›å‹æ–¹æ³•"></a>æ³›å‹æ–¹æ³•</h3><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/075218b91c3a42418fe096972490a7fd~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1199&h=543&s=25686&e=png&b=fefefe" alt="image.png"><br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/de3e70bb1a0c4e27b035264405a907f7~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=950&h=248&s=22406&e=png&b=ffffff" alt="image.png"><br>è¯´æ˜ä¸€ä¸‹ï¼Œå®šä¹‰æ³›å‹æ–¹æ³•æ—¶ï¼Œå¿…é¡»åœ¨è¿”å›å€¼å‰è¾¹åŠ ä¸€ä¸ª<T>ï¼Œæ¥å£°æ˜è¿™æ˜¯ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼ŒæŒæœ‰ä¸€ä¸ªæ³›å‹Tï¼Œç„¶åæ‰å¯ä»¥ç”¨æ³›å‹Tä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ã€‚<br>Class<T>çš„ä½œç”¨å°±æ˜¯æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹ï¼Œè€ŒClass<T>ç±»å‹çš„å˜é‡cï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºæ³›å‹ç±»çš„å¯¹è±¡ã€‚<br>ä¸ºä»€ä¹ˆè¦ç”¨å˜é‡cæ¥åˆ›å»ºå¯¹è±¡å‘¢ï¼Ÿæ—¢ç„¶æ˜¯æ³›å‹æ–¹æ³•ï¼Œå°±ä»£è¡¨ç€æˆ‘ä»¬ä¸çŸ¥é“å…·ä½“çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Œä¹Ÿä¸çŸ¥é“æ„é€ æ–¹æ³•å¦‚ä½•ï¼Œå› æ­¤æ²¡æœ‰åŠæ³•å»newä¸€ä¸ªå¯¹è±¡ï¼Œä½†å¯ä»¥åˆ©ç”¨å˜é‡cçš„newInstanceæ–¹æ³•å»åˆ›å»ºå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨åå°„åˆ›å»ºå¯¹è±¡ã€‚<br>æ³›å‹æ–¹æ³•è¦æ±‚çš„å‚æ•°æ˜¯Class<T>ç±»å‹ï¼Œè€ŒClass.forName()æ–¹æ³•çš„è¿”å›å€¼ä¹Ÿæ˜¯Class<T>ï¼Œå› æ­¤å¯ä»¥ç”¨Class.forName()ä½œä¸ºå‚æ•°ã€‚å…¶ä¸­ï¼ŒforName()æ–¹æ³•ä¸­çš„å‚æ•°æ˜¯ä½•ç§ç±»å‹ï¼Œè¿”å›çš„Class<T>å°±æ˜¯ä½•ç§ç±»å‹ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼ŒforName()æ–¹æ³•ä¸­ä¼ å…¥çš„æ˜¯Userç±»çš„å®Œæ•´è·¯å¾„ï¼Œå› æ­¤è¿”å›çš„æ˜¯Class<User>ç±»å‹çš„å¯¹è±¡ï¼Œå› æ­¤è°ƒç”¨æ³›å‹æ–¹æ³•æ—¶ï¼Œå˜é‡cçš„ç±»å‹å°±æ˜¯Class<User>ï¼Œå› æ­¤æ³›å‹æ–¹æ³•ä¸­çš„æ³›å‹Tå°±è¢«æŒ‡æ˜ä¸ºUserï¼Œå› æ­¤å˜é‡objçš„ç±»å‹ä¸ºUserã€‚<br>å½“ç„¶ï¼Œæ³›å‹æ–¹æ³•ä¸æ˜¯ä»…ä»…å¯ä»¥æœ‰ä¸€ä¸ªå‚æ•°Class<T>ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ å…¶ä»–å‚æ•°ã€‚<br><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³›å‹æ–¹æ³•å‘¢</strong>ï¼Ÿ<br>å› ä¸ºæ³›å‹ç±»è¦åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°±æŒ‡æ˜ç±»å‹ï¼Œå¦‚æœæƒ³æ¢ä¸€ç§ç±»å‹ï¼Œä¸å¾—ä¸é‡æ–°newä¸€æ¬¡ï¼Œå¯èƒ½ä¸å¤Ÿçµæ´»ï¼›è€Œæ³›å‹æ–¹æ³•å¯ä»¥åœ¨è°ƒç”¨çš„æ—¶å€™æŒ‡æ˜ç±»å‹ï¼Œæ›´åŠ çµæ´»ã€‚</p>
<h3 id="æ³›å‹ä¸Šä¸‹é™"><a href="#æ³›å‹ä¸Šä¸‹é™" class="headerlink" title="æ³›å‹ä¸Šä¸‹é™"></a>æ³›å‹ä¸Šä¸‹é™</h3><pre><code class="java">    public static void funC(List&lt;? extends A&gt; listA) &#123;
        // ...          
    &#125;
    public static void funD(List&lt;B&gt; listB) &#123;
        funC(listB); // OK
        // ...             
    &#125;
</code></pre>
<p>ä¸ºäº†è§£å†³æ³›å‹ä¸­éšå«çš„è½¬æ¢é—®é¢˜ï¼ŒJavaæ³›å‹åŠ å…¥äº†ç±»å‹å‚æ•°çš„ä¸Šä¸‹è¾¹ç•Œæœºåˆ¶ã€‚&lt;? extends A&gt;è¡¨ç¤ºè¯¥ç±»å‹å‚æ•°å¯ä»¥æ˜¯A(ä¸Šè¾¹ç•Œ)æˆ–è€…Açš„å­ç±»ç±»å‹ã€‚ç¼–è¯‘æ—¶æ“¦é™¤åˆ°ç±»å‹Aï¼Œå³ç”¨Aç±»å‹ä»£æ›¿ç±»å‹å‚æ•°ã€‚è¿™ç§æ–¹æ³•å¯ä»¥è§£å†³å¼€å§‹é‡åˆ°çš„é—®é¢˜ï¼Œç¼–è¯‘å™¨çŸ¥é“ç±»å‹å‚æ•°çš„èŒƒå›´ï¼Œå¦‚æœä¼ å…¥çš„å®ä¾‹ç±»å‹Bæ˜¯åœ¨è¿™ä¸ªèŒƒå›´å†…çš„è¯å…è®¸è½¬æ¢ï¼Œè¿™æ—¶åªè¦ä¸€æ¬¡ç±»å‹è½¬æ¢å°±å¯ä»¥äº†ï¼Œè¿è¡Œæ—¶ä¼šæŠŠå¯¹è±¡å½“åšAçš„å®ä¾‹çœ‹å¾…ã€‚<br>å¦‚æœä¸ç”¨æ³›å‹å°±ä¼šæŠ¥é”™ï¼š</p>
<p>ä¸Šç•Œï¼š</p>
<pre><code class="java">class Info&lt;T extends Number&gt;&#123;    // æ­¤å¤„æ³›å‹åªèƒ½æ˜¯æ•°å­—ç±»å‹
</code></pre>
<p>ä¸‹ç•Œï¼š</p>
<pre><code class="java">    public static void fun(Info&lt;? super String&gt; temp)&#123;    // åªèƒ½æ¥æ”¶Stringæˆ–Objectç±»å‹çš„æ³›å‹ï¼ŒStringç±»çš„çˆ¶ç±»åªæœ‰Objectç±»
</code></pre>
<p>å°ç»“ï¼š</p>
<pre><code class="java">&lt;?&gt; æ— é™åˆ¶é€šé…ç¬¦
&lt;? extends E&gt; extends å…³é”®å­—å£°æ˜äº†ç±»å‹çš„ä¸Šç•Œï¼Œè¡¨ç¤ºå‚æ•°åŒ–çš„ç±»å‹å¯èƒ½æ˜¯æ‰€æŒ‡å®šçš„ç±»å‹ï¼Œæˆ–è€…æ˜¯æ­¤ç±»å‹çš„å­ç±»
&lt;? super E&gt; super å…³é”®å­—å£°æ˜äº†ç±»å‹çš„ä¸‹ç•Œï¼Œè¡¨ç¤ºå‚æ•°åŒ–çš„ç±»å‹å¯èƒ½æ˜¯æŒ‡å®šçš„ç±»å‹ï¼Œæˆ–è€…æ˜¯æ­¤ç±»å‹çš„çˆ¶ç±»

// ä½¿ç”¨åŸåˆ™ã€ŠEffictive Javaã€‹
// ä¸ºäº†è·å¾—æœ€å¤§é™åº¦çš„çµæ´»æ€§ï¼Œè¦åœ¨è¡¨ç¤º ç”Ÿäº§è€…æˆ–è€…æ¶ˆè´¹è€… çš„è¾“å…¥å‚æ•°ä¸Šä½¿ç”¨é€šé…ç¬¦ï¼Œä½¿ç”¨çš„è§„åˆ™å°±æ˜¯ï¼šç”Ÿäº§è€…æœ‰ä¸Šé™ã€æ¶ˆè´¹è€…æœ‰ä¸‹é™
1. å¦‚æœå‚æ•°åŒ–ç±»å‹è¡¨ç¤ºä¸€ä¸ª T çš„ç”Ÿäº§è€…ï¼Œä½¿ç”¨ &lt; ? extends T&gt;;
2. å¦‚æœå®ƒè¡¨ç¤ºä¸€ä¸ª T çš„æ¶ˆè´¹è€…ï¼Œå°±ä½¿ç”¨ &lt; ? super T&gt;ï¼›
3. å¦‚æœæ—¢æ˜¯ç”Ÿäº§åˆæ˜¯æ¶ˆè´¹ï¼Œé‚£ä½¿ç”¨é€šé…ç¬¦å°±æ²¡ä»€ä¹ˆæ„ä¹‰äº†ï¼Œå› ä¸ºä½ éœ€è¦çš„æ˜¯ç²¾ç¡®çš„å‚æ•°ç±»å‹ã€‚
</code></pre>
<h3 id="æ³›å‹æ•°ç»„"><a href="#æ³›å‹æ•°ç»„" class="headerlink" title="æ³›å‹æ•°ç»„"></a>æ³›å‹æ•°ç»„</h3><pre><code class="java">List&lt;String&gt;[] list11 = new ArrayList&lt;String&gt;[10]; //ç¼–è¯‘é”™è¯¯ï¼Œéæ³•åˆ›å»º 
List&lt;String&gt;[] list12 = new ArrayList&lt;?&gt;[10]; //ç¼–è¯‘é”™è¯¯ï¼Œéœ€è¦å¼ºè½¬ç±»å‹ 
List&lt;String&gt;[] list13 = (List&lt;String&gt;[]) new ArrayList&lt;?&gt;[10]; //OKï¼Œä½†æ˜¯ä¼šæœ‰è­¦å‘Š 
List&lt;?&gt;[] list14 = new ArrayList&lt;String&gt;[10]; //ç¼–è¯‘é”™è¯¯ï¼Œéæ³•åˆ›å»º 
List&lt;?&gt;[] list15 = new ArrayList&lt;?&gt;[10]; //OK 
List&lt;String&gt;[] list6 = new ArrayList[10]; //OKï¼Œä½†æ˜¯ä¼šæœ‰è­¦å‘Š
</code></pre>
<ul>
<li>ä½¿ç”¨åœºæ™¯</li>
</ul>
<pre><code class="java">public class GenericsDemo30&#123;  
    public static void main(String args[])&#123;  
        Integer i[] = fun1(1,2,3,4,5,6) ;   // è¿”å›æ³›å‹æ•°ç»„  
        fun2(i) ;  
    &#125;  
    public static &lt;T&gt; T[] fun1(T...arg)&#123;  // æ¥æ”¶å¯å˜å‚æ•°  
        return arg ;            // è¿”å›æ³›å‹æ•°ç»„  
    &#125;  
    public static &lt;T&gt; void fun2(T param[])&#123;   // è¾“å‡º  
        System.out.print(&quot;æ¥æ”¶æ³›å‹æ•°ç»„ï¼š&quot;) ;  
        for(T t:param)&#123;  
            System.out.print(t + &quot;ã€&quot;) ;  
        &#125;  
    &#125;  
&#125;
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/da0e9136ae784482a65592dd47561d02~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1756&h=1130&s=248753&e=png&b=222427" alt="image.png"></p>
<h1 id="æ·±å…¥ç†è§£æ³›å‹"><a href="#æ·±å…¥ç†è§£æ³›å‹" class="headerlink" title="æ·±å…¥ç†è§£æ³›å‹"></a>æ·±å…¥ç†è§£æ³›å‹</h1><h2 id="ç±»å‹æ“¦é™¤"><a href="#ç±»å‹æ“¦é™¤" class="headerlink" title="ç±»å‹æ“¦é™¤"></a>ç±»å‹æ“¦é™¤</h2><p><strong>æ³›å‹çš„ç±»å‹æ“¦é™¤åŸåˆ™</strong>æ˜¯ï¼š</p>
<ul>
<li>æ¶ˆé™¤ç±»å‹å‚æ•°å£°æ˜ï¼Œå³åˆ é™¤&lt;&gt;åŠå…¶åŒ…å›´çš„éƒ¨åˆ†ã€‚</li>
<li>æ ¹æ®ç±»å‹å‚æ•°çš„ä¸Šä¸‹ç•Œæ¨æ–­å¹¶æ›¿æ¢æ‰€æœ‰çš„ç±»å‹å‚æ•°ä¸ºåŸç”Ÿæ€ç±»å‹ï¼šå¦‚æœç±»å‹å‚æ•°æ˜¯æ— é™åˆ¶é€šé…ç¬¦æˆ–æ²¡æœ‰ä¸Šä¸‹ç•Œé™å®šåˆ™æ›¿æ¢ä¸ºObjectï¼Œå¦‚æœå­˜åœ¨ä¸Šä¸‹ç•Œé™å®šåˆ™æ ¹æ®å­ç±»æ›¿æ¢åŸåˆ™å–ç±»å‹å‚æ•°çš„æœ€å·¦è¾¹é™å®šç±»å‹ï¼ˆå³çˆ¶ç±»ï¼‰ã€‚</li>
<li>ä¸ºäº†ä¿è¯ç±»å‹å®‰å…¨ï¼Œå¿…è¦æ—¶æ’å…¥å¼ºåˆ¶ç±»å‹è½¬æ¢ä»£ç ã€‚</li>
<li>è‡ªåŠ¨äº§ç”Ÿâ€œæ¡¥æ¥æ–¹æ³•â€ä»¥ä¿è¯æ“¦é™¤ç±»å‹åçš„ä»£ç ä»ç„¶å…·æœ‰æ³›å‹çš„â€œå¤šæ€æ€§â€ã€‚</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c2dc031266c04baf8fca9ac12a25ad22~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=776&h=223&s=30986&e=png&a=1&b=000000" alt="image.png"><br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d4ac4d20ae2a479fb71d9ff2f7a7101e~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=822&h=236&s=31204&e=png&a=1&b=000000" alt="image.png"><br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a56013c830d44a2fa84bac6bc42eb717~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=982&h=144&s=20440&e=png&a=1&b=fb9f00" alt="image.png"></p>
<h2 id="ç±»å‹æ“¦é™¤ä¿ç•™çš„åŸå§‹ç±»å‹"><a href="#ç±»å‹æ“¦é™¤ä¿ç•™çš„åŸå§‹ç±»å‹" class="headerlink" title="ç±»å‹æ“¦é™¤ä¿ç•™çš„åŸå§‹ç±»å‹"></a>ç±»å‹æ“¦é™¤ä¿ç•™çš„åŸå§‹ç±»å‹</h2><p>åŸå§‹ç±»å‹ å°±æ˜¯æ“¦é™¤å»äº†æ³›å‹ä¿¡æ¯ï¼Œæœ€ååœ¨å­—èŠ‚ç ä¸­çš„ç±»å‹å˜é‡çš„çœŸæ­£ç±»å‹ï¼Œæ— è®ºä½•æ—¶å®šä¹‰ä¸€ä¸ªæ³›å‹ï¼Œç›¸åº”çš„åŸå§‹ç±»å‹éƒ½ä¼šè¢«è‡ªåŠ¨æä¾›ï¼Œç±»å‹å˜é‡æ“¦é™¤ï¼Œå¹¶ä½¿ç”¨å…¶é™å®šç±»å‹ï¼ˆæ— é™å®šçš„å˜é‡ç”¨Objectï¼‰æ›¿æ¢ã€‚</p>
<h2 id="æ³›å‹åœ¨ç¼–è¯‘å™¨çš„æ£€æŸ¥"><a href="#æ³›å‹åœ¨ç¼–è¯‘å™¨çš„æ£€æŸ¥" class="headerlink" title="æ³›å‹åœ¨ç¼–è¯‘å™¨çš„æ£€æŸ¥"></a>æ³›å‹åœ¨ç¼–è¯‘å™¨çš„æ£€æŸ¥</h2><p>javaç¼–è¯‘å™¨æ˜¯é€šè¿‡å…ˆæ£€æŸ¥ä»£ç ä¸­æ³›å‹çš„ç±»å‹ï¼Œç„¶ååœ¨è¿›è¡Œç±»å‹æ“¦é™¤ï¼Œå†è¿›è¡Œç¼–è¯‘ã€‚<br>ä¾‹å¦‚ï¼š</p>
<pre><code class="java">public static  void main(String[] args) &#123;  

    ArrayList&lt;String&gt; list = new ArrayList&lt;String&gt;();  
    list.add(&quot;123&quot;);  
    list.add(123);//ç¼–è¯‘é”™è¯¯  
&#125;
</code></pre>
<p>åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œä½¿ç”¨addæ–¹æ³•æ·»åŠ ä¸€ä¸ªæ•´å‹ï¼Œåœ¨IDEä¸­ï¼Œç›´æ¥ä¼šæŠ¥é”™ï¼Œè¯´æ˜è¿™å°±æ˜¯åœ¨ç¼–è¯‘ä¹‹å‰çš„æ£€æŸ¥ï¼Œå› ä¸ºå¦‚æœæ˜¯åœ¨ç¼–è¯‘ä¹‹åæ£€æŸ¥ï¼Œç±»å‹æ“¦é™¤åï¼ŒåŸå§‹ç±»å‹ä¸ºObjectï¼Œæ˜¯åº”è¯¥å…è®¸ä»»æ„å¼•ç”¨ç±»å‹æ·»åŠ çš„ã€‚å¯å®é™…ä¸Šå´ä¸æ˜¯è¿™æ ·çš„ï¼Œè¿™æ°æ°è¯´æ˜äº†å…³äºæ³›å‹å˜é‡çš„ä½¿ç”¨ï¼Œæ˜¯ä¼šåœ¨ç¼–è¯‘ä¹‹å‰æ£€æŸ¥çš„ã€‚</p>
<h1 id="é¡¹ç›®ä¸­çš„æ³›å‹å®æˆ˜"><a href="#é¡¹ç›®ä¸­çš„æ³›å‹å®æˆ˜" class="headerlink" title="é¡¹ç›®ä¸­çš„æ³›å‹å®æˆ˜"></a>é¡¹ç›®ä¸­çš„æ³›å‹å®æˆ˜</h1><p>æ³›å‹å¾ˆå¤šéƒ½æ˜¯ç†è®ºï¼Œåœ¨é¡¹ç›®ä¸­æ€ä¹ˆç”¨å‘¢ï¼Ÿ<br>æ¯”å¦‚å¯¹äºå¸¸è§çš„ç¼“å­˜ç©¿é€ï¼Œç¼“å­˜å‡»ç©¿ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ³›å‹å°†å…¶å°è£…åˆ°ä¸€ä¸ªç±»é‡Œé¢ã€‚<br>æ¯”å¦‚ä¸‹é¢ä»£ç ï¼Œæ˜¯é»‘é©¬ç‚¹è¯„é¡¹ç›®ä¸­çš„ä¸€ä¸ªç‚¹ï¼š<strong>é€šè¿‡æ³›å‹ + å‡½æ•°å¼ç¼–ç¨‹å°è£…æˆé€šç”¨è§£å†³æ–¹æ¡ˆã€‚</strong><br><strong>éš¾ç‚¹ï¼š</strong></p>
<ul>
<li><strong>æ³›å‹æ–¹æ³•</strong>çš„ä½¿ç”¨ï¼šè¿”å›å€¼ç±»å‹ä¸ç¡®å®šã€idç±»å‹ä¸ç¡®å®šã€‚æ‰€ä»¥å°±å£°æ˜æ³›å‹ï¼Œ<strong>è®©è°ƒç”¨è€…å‘Šè¯‰æˆ‘ä»¬æ³›å‹</strong>æ˜¯ä»€ä¹ˆï¼›</li>
<li><strong>ä½¿ç”¨å‡½æ•°å¼æ¥å£</strong>ï¼šç‰µæ‰¯åˆ°æ•°æ®åº“æŸ¥è¯¢ï¼Œéœ€è¦å‚æ•°å’Œè¿”å›å€¼ï¼Œä½¿ç”¨å‡½æ•°å¼æ¥å£Function&lt;ID,R&gt;<ul>
<li>å››å¤§å‡½æ•°å¼æ¥å£ Function&lt;T,R&gt;   Predicate<T>    Consumer<T>    Supplier<T></li>
</ul>
</li>
</ul>
<pre><code class="java">/**
 * ç¼“å­˜å·¥å…·å°è£…
 */
@Slf4j
@Component
public class CacheClient &#123;

    @Resource
    private StringRedisTemplate stringRedisTemplate;
    //ç¼“å­˜å‡»ç©¿ä½¿ç”¨çš„çº¿ç¨‹æ± 
    private static final ExecutorService CACHE_REBUILD_EXECUTOR = Executors.newFixedThreadPool(10);

    /**
     * å°†ä»»æ„javaå¯¹è±¡åºåˆ—åŒ–ä¸ºjsonå­—ç¬¦ä¸²å¹¶å­˜å‚¨åœ¨stringç±»å‹çš„keyä¸­ï¼Œå¹¶è®¾ç½®TTL
     *
     * @param key   stringç±»å‹çš„key
     * @param value ä»»æ„javaå¯¹è±¡
     * @param time  æ—¶é—´
     * @param unit  å•ä½
     */
    public void set(String key, Object value, Long time, TimeUnit unit) &#123;
        stringRedisTemplate.opsForValue().set(key, JSONUtil.toJsonStr(value), time, unit);
    &#125;

    /**
     * å°†ä»»æ„javaå¯¹è±¡åºåˆ—åŒ–ä¸ºjsonå­—ç¬¦ä¸²å¹¶å­˜å‚¨åœ¨stringç±»å‹çš„keyä¸­ï¼Œå¹¶è®¾ç½®é€»è¾‘è¿‡æœŸæ—¶é—´ï¼Œç”¨äºå¤„ç†ç¼“å­˜å‡»ç©¿
     *
     * @param key   stringç±»å‹çš„key
     * @param value ä»»æ„javaå¯¹è±¡
     * @param time  é€»è¾‘æ—¶é—´
     * @param unit  å•ä½
     */
    public void setWithLogicalExpire(String key, Object value, Long time, TimeUnit unit) &#123;
        // RedisDataå¯¹è±¡ï¼Œè®¾ç½®é€»è¾‘è¿‡æœŸ
        RedisData redisData = new RedisData();
        redisData.setData(value);
        redisData.setExpireTime(LocalDateTime.now().plusSeconds(unit.toSeconds(time)));
        // å†™å…¥Redis
        stringRedisTemplate.opsForValue().set(key, JSONUtil.toJsonStr(redisData));
    &#125;

    /**
     * è§£å†³ç¼“å­˜ç©¿é€
     *
     * @param keyPrefix  keyå‰ç¼€
     * @param id         idä¸çŸ¥é“ä»€ä¹ˆç±»å‹ï¼Œæ‰€ä»¥éœ€è¦å£°åæ³›å‹IDï¼Œåå­—éšæ„èµ·
     * @param type       æ˜¯ä»€ä¹ˆç±»å‹
     * @param dbFallback å¦‚æœredisæŸ¥è¯¢çš„ä¸æ˜¯&quot;&quot;ï¼Œé‚£å°±éœ€è¦æŸ¥è¯¢æ•°æ®åº“ï¼Œå‡½æ•°å¼æ¥å£æŒ‡å®šé€»è¾‘
     * @param time       é‡å»ºç¼“å­˜åçš„æœ‰æ•ˆæ—¶é—´
     * @param unit       æ—¶é—´å•ä½
     * @param &lt;R&gt;        è¿”å›å€¼ç±»å‹ï¼Œä¾‹å¦‚Shopç±»å‹
     * @param &lt;ID&gt;       idä¸çŸ¥é“ä»€ä¹ˆç±»å‹ï¼Œæ‰€ä»¥éœ€è¦å£°åæ³›å‹IDï¼Œåå­—éšæ„èµ·
     * @return
     */
    public &lt;R, ID&gt; R queryWithPassThrough(
            String keyPrefix, ID id, Class&lt;R&gt; type, Function&lt;ID, R&gt; dbFallback, Long time, TimeUnit unit) &#123;
        String key = keyPrefix + id;
        // 1.ä»redisæŸ¥è¯¢ç¼“å­˜
        String json = stringRedisTemplate.opsForValue().get(key);
        // 2.åˆ¤æ–­æ˜¯å¦å­˜åœ¨ ã€‚isNotBlankåªæœ‰åœ¨ å­—ç¬¦ä¸² æ‰è¿”å›trueã€‚ æ¢è¡Œ ï¼Œnull, &quot;&quot;ç­‰éƒ½æ˜¯false
        if (StrUtil.isNotBlank(json)) &#123;
        // 3.å­˜åœ¨ï¼Œç›´æ¥è¿”å›
            return JSONUtil.toBean(json, type);
        &#125;
        //      3.2  å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æœ‰  nullï¼Œ&quot;&quot;,æ¢è¡Œ  ç­‰å¯èƒ½æ€§ã€‚å¦‚æœæ˜¯&quot;&quot;ï¼Œ åˆ™æ˜¯ä¸ºäº†è§£å†³ç¼“å­˜ç©¿é€è€Œçº¦å®šçš„è§„åˆ™
        if (&quot;&quot;.equals(json)) &#123;
            // è§£å†³ç¼“å­˜ç©¿é€ï¼Œä¸ä¼šå†å»æŸ¥æ•°æ®åº“
            return null;
        &#125;

        // 4.å¦‚æœä¸å­˜åœ¨ï¼Œä¸”ä¸æ˜¯&quot;&quot; ï¼›é‚£ä¹ˆåŸå› å¯èƒ½æ˜¯ç¼“å­˜ä¸­ä¸ºnullï¼Œéœ€è¦æ ¹æ®idå»æŸ¥è¯¢æ•°æ®åº“
        R r = dbFallback.apply(id);
        // 5.ä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯
        if (r == null) &#123;
            // å°†ç©ºå€¼å†™å…¥redis
            stringRedisTemplate.opsForValue().set(key, &quot;&quot;, CACHE_NULL_TTL, TimeUnit.MINUTES);
            // è¿”å›é”™è¯¯ä¿¡æ¯
            return null;
        &#125;
        // 6.å­˜åœ¨ï¼Œå†™å…¥redisï¼Œè°ƒç”¨å·²ç»å†™å¥½çš„æ–¹æ³•,è¶…æ—¶å‰”é™¤
        this.set(key, r, time, unit);
        return r;
    &#125;

    /**
     * é€»è¾‘è¿‡æœŸ è§£å†³ç¼“å­˜å‡»ç©¿
     */
    public &lt;R, ID&gt; R queryWithLogicalExpire(
            String keyPrefix, ID id, Class&lt;R&gt; type,String lockKeyPrefix, Function&lt;ID, R&gt; dbFallback, Long time, TimeUnit unit) &#123;
        String key = keyPrefix + id;
        // 1.ä»redisæŸ¥è¯¢ç¼“å­˜
        String json = stringRedisTemplate.opsForValue().get(key);
        // 2.åˆ¤æ–­æ˜¯å¦å­˜åœ¨
        if (StrUtil.isBlank(json)) &#123;
            //  3.1 ä¸å­˜åœ¨ç›´æ¥è¿”å›nullï¼Œä¸æ˜¯çƒ­ç‚¹key
            return null;
        &#125;
            //  3.2 å­˜åœ¨ï¼Œååºåˆ—åŒ–ä¸ºRedisDataå¯¹è±¡
        RedisData redisData = JSONUtil.toBean(json, RedisData.class);
        //        å¾—åˆ°Rå¯¹è±¡
        R r = JSONUtil.toBean((JSONObject) redisData.getData(), type);
        LocalDateTime expireTime = redisData.getExpireTime();
        // 4.åˆ¤æ–­æ˜¯å¦è¿‡æœŸ
        if (expireTime.isAfter(LocalDateTime.now())) &#123;
            // 4.1.æœªè¿‡æœŸï¼Œç›´æ¥è¿”å›
            return r;
        &#125;
        // 5. å·²è¿‡æœŸï¼Œéœ€è¦ç¼“å­˜é‡å»º
        // 6.ç¼“å­˜é‡å»º
        // 6.1.è·å–äº’æ–¥é”
        String lockKey = lockKeyPrefix + id;
        boolean isLock = tryLock(lockKey);
        // 6.2.åˆ¤æ–­æ˜¯å¦è·å–é”æˆåŠŸ
        if (isLock) &#123;
            // 6.3.æˆåŠŸï¼Œå¼€å¯ç‹¬ç«‹çº¿ç¨‹ï¼Œå®ç°ç¼“å­˜é‡å»º
//            åœ¨è¿™ä¹‹å‰éœ€è¦DoubleCheckï¼Œå†æ¬¡æŸ¥çœ‹redisç¼“å­˜æ˜¯å¦è¿‡æœŸ
            json = stringRedisTemplate.opsForValue().get(key);
//            åˆ¤æ–­æ˜¯å¦å­˜åœ¨
            if (StrUtil.isNotBlank(json)) &#123;
                //            5.2.2.1 å­˜åœ¨åˆ™åˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼Œæœªè¿‡æœŸå°±ç›´æ¥è¿”å›ï¼Œä¸éœ€è¦ç¼“å­˜æ„å»º
                redisData = JSONUtil.toBean(json, RedisData.class);
                r = JSONUtil.toBean((JSONObject) redisData.getData(), type);
                expireTime = redisData.getExpireTime();
                if (expireTime.isAfter(LocalDateTime.now())) &#123;
                    //   æœªè¿‡æœŸï¼Œç›´æ¥è¿”å›
                    return r;
                &#125;
            &#125;
            //   6.4 å·²è¿‡æœŸ || ä¸å­˜åœ¨  åˆ™é‡æ–°æ„å»ºï¼Œå¼€å¯çº¿ç¨‹æ± ï¼ˆå¦‚æœè‡ªå·±new çº¿ç¨‹ï¼Œæ€§èƒ½ä¸å¥½ï¼‰

            CACHE_REBUILD_EXECUTOR.submit(() -&gt; &#123;
                try &#123;
                    // æŸ¥è¯¢æ•°æ®åº“
                    R newR = dbFallback.apply(id);
                    // é‡å»ºç¼“å­˜--çƒ­ç‚¹key
                    this.setWithLogicalExpire(key, newR, time, unit);
                &#125; catch (Exception e) &#123;
                    throw new RuntimeException(e);
                &#125; finally &#123;
                    // é‡Šæ”¾é”
                    unlock(lockKey);
                &#125;
            &#125;);
        &#125;
        // 6.4.è¿”å›è¿‡æœŸçš„ä¿¡æ¯
        return r;
    &#125;

    /**
     * äº’æ–¥é” è§£å†³ç¼“å­˜å‡»ç©¿
     */
    public &lt;R, ID&gt; R queryWithMutex(
            String keyPrefix, ID id, Class&lt;R&gt; type,String lockKeyPrefix, long sleepTime,Function&lt;ID, R&gt; dbFallback, Long time, TimeUnit unit) &#123;
        String key = keyPrefix + id;
        // 1.ä»redisæŸ¥è¯¢ç¼“å­˜
        String json = stringRedisTemplate.opsForValue().get(key);
//        2.åˆ¤æ–­æ˜¯å¦å­˜åœ¨ ã€‚isNotBlankåªæœ‰åœ¨ å­—ç¬¦ä¸² æ‰è¿”å›trueã€‚ æ¢è¡Œ ï¼Œnull, &quot;&quot;ç­‰éƒ½æ˜¯false
        if (StrUtil.isNotBlank(json)) &#123;
            // 3.å­˜åœ¨ï¼Œç›´æ¥è¿”å›
            return JSONUtil.toBean(json, type);
        &#125;
//      3.2  å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æœ‰  nullï¼Œ&quot;&quot;,æ¢è¡Œ  ç­‰å¯èƒ½æ€§ã€‚å¦‚æœæ˜¯&quot;&quot;ï¼Œ åˆ™æ˜¯ä¸ºäº†è§£å†³ç¼“å­˜ç©¿é€è€Œçº¦å®šçš„è§„åˆ™
        if (&quot;&quot;.equals(json)) &#123;
//            è§£å†³ç¼“å­˜ç©¿é€ï¼Œä¸ä¼šå†å»æŸ¥æ•°æ®åº“
            return null;
        &#125;

//        4.å¦‚æœä¸å­˜åœ¨ï¼Œä¸”ä¸æ˜¯&quot;&quot; ï¼›é‚£ä¹ˆåŸå› å¯èƒ½æ˜¯ç¼“å­˜ä¸­ä¸ºnullï¼Œéœ€è¦æ ¹æ®idå»æŸ¥è¯¢æ•°æ®åº“
//        ==========è§£å†³ç¼“å­˜å‡»ç©¿==========
//        4.1 è·å–äº’æ–¥é”
        String lockKey = lockKeyPrefix + id;
        R r = null;
        try &#123;
            boolean isLock = tryLock(lockKey);
            // 4.2.åˆ¤æ–­æ˜¯å¦è·å–æˆåŠŸ
            if (!isLock) &#123;
                // 4.3.è·å–é”å¤±è´¥ï¼Œä¼‘çœ å¹¶é‡è¯•
                Thread.sleep(sleepTime);
                return queryWithMutex(keyPrefix, id ,type,lockKeyPrefix,sleepTime, dbFallback, time, unit);
            &#125;
            // 4.4 æˆåŠŸï¼ŒåšåŒé‡æ£€æŸ¥é”ï¼ŒæŸ¥çœ‹redisç¼“å­˜æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™æ— éœ€é‡å»ºç¼“å­˜
            json = stringRedisTemplate.opsForValue().get(key);
            // åˆ¤æ–­æ˜¯å¦å­˜åœ¨ ã€‚isNotBlankåªæœ‰åœ¨ å­—ç¬¦ä¸² æ‰è¿”å›trueã€‚ æ¢è¡Œ ï¼Œnull, &quot;&quot;ç­‰éƒ½æ˜¯false
            if (StrUtil.isNotBlank(json)) &#123;
                //   å­˜åœ¨ç›´æ¥è¿”å›
                r = JSONUtil.toBean(json, type);
                return r;
            &#125;
            //   å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æœ‰  nullï¼Œ&quot;&quot;,æ¢è¡Œ  ç­‰å¯èƒ½æ€§ã€‚å¦‚æœæ˜¯&quot;&quot;ï¼Œ åˆ™æ˜¯ä¸ºäº†è§£å†³ç¼“å­˜ç©¿é€è€Œçº¦å®šçš„è§„åˆ™
            if (&quot;&quot;.equals(json)) &#123;
                //           è§£å†³ç¼“å­˜ç©¿é€ï¼Œä¸ä¼šå†å»æŸ¥æ•°æ®åº“
                return null;
            &#125;
            //  5. åˆ°è¿™é‡Œè¯´æ˜é€šè¿‡åŒé‡æ£€æŸ¥é”ï¼Œä»£è¡¨æ˜¯ç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œåˆ™æ ¹æ®idæŸ¥è¯¢æ•°æ®åº“
            r = dbFallback.apply(id);
            // ä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯
            if (r == null) &#123;
                // å°†ç©ºå€¼å†™å…¥redis
                stringRedisTemplate.opsForValue().set(key, &quot;&quot;, CACHE_NULL_TTL, TimeUnit.MINUTES);
                // è¿”å›é”™è¯¯ä¿¡æ¯
                return null;
            &#125;
            // 6.å­˜åœ¨ï¼Œå†™å…¥redis
            this.set(key, r, time, unit);
        &#125; catch (InterruptedException e) &#123;
            throw new RuntimeException(e);
        &#125; finally &#123;
            // 7.é‡Šæ”¾é”
            unlock(lockKey);
        &#125;
        // 8.è¿”å›
        return r;
    &#125;

    private boolean tryLock(String key) &#123;
        Boolean flag = stringRedisTemplate.opsForValue().setIfAbsent(key, &quot;1&quot;, 10, TimeUnit.SECONDS);
//        ä¸è¦ç›´æ¥è¿”å›ï¼Œå› ä¸ºä¼šè‡ªåŠ¨æ‹†ç®±ï¼Œå¦‚æœä¸ºnullï¼Œä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚
//        ä½¿ç”¨å·¥å…·ç±»
        return BooleanUtil.isTrue(flag);
    &#125;

    private void unlock(String key) &#123;
        stringRedisTemplate.delete(key);
    &#125;
&#125;
</code></pre>
<p>å‚è€ƒæ–‡ç« ï¼š<br><a target="_blank" rel="noopener" href="https://pdai.tech/md/java/basic/java-basic-x-generic.html#%E6%B3%9B%E5%9E%8B%E7%B1%BB">https://pdai.tech/md/java/basic/java-basic-x-generic.html#æ³›å‹ç±»</a><br>    <a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903925666021389?searchId=202402142156151370FABE70EBA2501841#heading-8">https://juejin.cn/post/6844903925666021389?searchId=202402142156151370FABE70EBA2501841#heading-8</a></p>
</div><div class="p-copyright"><blockquote><div class="p-copyright-author"><span class="p-copyright-key">æœ¬æ–‡ä½œè€…ï¼š</span><span class="p-copytight-value"><a href="mailto:litreily@163.com">Lorain</a></span></div><div class="p-copyright-link"><span class="p-copyright-key">æœ¬æ–‡é“¾æ¥ï¼š</span><span class="p-copytight-value"><a href="/posts/20748c35.html">https://axdmdyj.github.io/posts/20748c35.html</a></span></div><div class="p-copyright-note"><span class="p-copyright-key">ç‰ˆæƒå£°æ˜ï¼š</span><span class="p-copytight-value">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹æ®Šå£°æ˜å¤–ï¼Œå‡é‡‡ç”¨<a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/"> CC BY-NC 4.0 </a>è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ <a href="https://axdmdyj.github.io">Lorainçš„åšå®¢</a>ï¼</span></div></blockquote></div></article><div class="p-info box"><span class="p-tags"><i class="fa fa-tag"></i><a href="/tags/%E6%B3%9B%E5%9E%8B/">æ³›å‹</a></span></div><aside id="toc"><div class="toc-title">ç›®å½•</div><nav><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">æ³›å‹åŸºç¡€</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BC%95%E5%85%A5%E6%B3%9B%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">ä¸ºä»€ä¹ˆå¼•å…¥æ³›å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">å®ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.</span> <span class="toc-text">æ³›å‹çš„åŸºæœ¬ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%B1%BB"><span class="toc-number">1.2.1.</span> <span class="toc-text">æ³›å‹ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.2.2.</span> <span class="toc-text">æ³›å‹æ¥å£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.3.</span> <span class="toc-text">æ³›å‹æ–¹æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E4%B8%8A%E4%B8%8B%E9%99%90"><span class="toc-number">1.2.4.</span> <span class="toc-text">æ³›å‹ä¸Šä¸‹é™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E6%95%B0%E7%BB%84"><span class="toc-number">1.2.5.</span> <span class="toc-text">æ³›å‹æ•°ç»„</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E6%B3%9B%E5%9E%8B"><span class="toc-number">2.</span> <span class="toc-text">æ·±å…¥ç†è§£æ³›å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E6%93%A6%E9%99%A4"><span class="toc-number">2.1.</span> <span class="toc-text">ç±»å‹æ“¦é™¤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E6%93%A6%E9%99%A4%E4%BF%9D%E7%95%99%E7%9A%84%E5%8E%9F%E5%A7%8B%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.2.</span> <span class="toc-text">ç±»å‹æ“¦é™¤ä¿ç•™çš„åŸå§‹ç±»å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E5%9C%A8%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E6%A3%80%E6%9F%A5"><span class="toc-number">2.3.</span> <span class="toc-text">æ³›å‹åœ¨ç¼–è¯‘å™¨çš„æ£€æŸ¥</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B%E5%AE%9E%E6%88%98"><span class="toc-number">3.</span> <span class="toc-text">é¡¹ç›®ä¸­çš„æ³›å‹å®æˆ˜</span></a></li></ol></nav></aside></div><section class="p-ext"><div class="l-pager l-pager-dtl box"><a class="prev" href="/posts/c31889ef.html">&lt; JVMå¸¸è§é—®é¢˜</a><a class="next" href="/posts/63f114ae.html">JVMåƒåœ¾å›æ”¶å…¥é—¨ï¼ˆçˆ±ä¸ŠJVMï¼ï¼ï¼‰ &gt;</a></div><div id="valine-comment"><style type="text/css">.night .v[data-class=v] a { color: #0F9FB4 !important; }
.night .v[data-class=v] a:hover { color: #216C73 !important; }
.night .v[data-class=v] li { list-style: inherit; }
.night .v[data-class=v] .vwrap { border: 1px solid #223441; border-radius: 0; }
.night .v[data-class=v] .vwrap:hover { box-shadow: 0 0 6px 1px #223441; }
.night .v[data-class=v] .vbtn { border-radius: 0; background: none; }
.night .v[data-class=v] .vlist .vcard .vh { border-bottom-color: #293D4E; }
.night .v[data-class=v] .vwrap .vheader .vinput { border-bottom-color: #223441; }
.night .v[data-class=v] .vwrap .vheader .vinput:focus { border-bottom-color: #339EB4; }
.night .v[data-class=v] code, .night .v[data-class=v] pre,.night .v[data-class=v] .vlist .vcard .vhead .vsys { background: #203240 !important; }
.night .v[data-class=v] code, .night .v[data-class=v] pre { color: #F0F0F0; font-size: 95%; }
.v[data-class=v] .vcards .vcard .vh {border-bottom-color: #223441; }
.night .v[data-class=v] .vcards .vcard .vcontent.expand:before {background: linear-gradient(180deg,rgba(38,57,73,.4),rgba(38,57,73,.9));}
.night .v[data-class=v] .vcards .vcard .vcontent.expand:after {background: rgba(38,57,73,.9)}
</style><div id="vcomment"></div><script src="//cdn.bootcdn.net/ajax/libs/valine/1.4.14/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'aX6NXi9vT0pNPR8RUR37YZmC-gzGzoHsz',
  appKey:'39u7DWzRXJqme25hLiHeHKho',
  lang: 'zh-cn',
  placeholder:'ãƒ¾ï¾‰â‰§âˆ€â‰¦)o Come on, say something...',
  avatar:'identicon',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></section><footer><p>Copyright Â© 2016 - 2024 <a href="/." rel="nofollow">Lorain's Blog</a> | <strong><a rel="nofollow" target="_blank" href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></strong><br><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span></span> <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span></span> | Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a>Theme with<a rel="nofollow" target="_blank" href="https://github.com/litreily/snark-hexo"> snark.</a></p></footer></div></div></div><script type="text/javascript" src="/js/search.js"></script><script type="text/javascript" src="/js/top.js"></script><script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
    search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1" async></script></body></html>